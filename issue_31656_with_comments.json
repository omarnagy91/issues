{
    "url": "https://api.github.com/repos/Expensify/App/issues/31656",
    "repository_url": "https://api.github.com/repos/Expensify/App",
    "labels_url": "https://api.github.com/repos/Expensify/App/issues/31656/labels{/name}",
    "comments_url": "https://api.github.com/repos/Expensify/App/issues/31656/comments",
    "events_url": "https://api.github.com/repos/Expensify/App/issues/31656/events",
    "html_url": "https://github.com/Expensify/App/pull/31656",
    "id": 2005113613,
    "node_id": "PR_kwDOEQqHYc5gENK_",
    "number": 31656,
    "title": "Implement ViolationUtils lib",
    "user": {
        "login": "trevor-coleman",
        "id": 22041394,
        "node_id": "MDQ6VXNlcjIyMDQxMzk0",
        "avatar_url": "https://avatars.githubusercontent.com/u/22041394?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/trevor-coleman",
        "html_url": "https://github.com/trevor-coleman",
        "followers_url": "https://api.github.com/users/trevor-coleman/followers",
        "following_url": "https://api.github.com/users/trevor-coleman/following{/other_user}",
        "gists_url": "https://api.github.com/users/trevor-coleman/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/trevor-coleman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/trevor-coleman/subscriptions",
        "organizations_url": "https://api.github.com/users/trevor-coleman/orgs",
        "repos_url": "https://api.github.com/users/trevor-coleman/repos",
        "events_url": "https://api.github.com/users/trevor-coleman/events{/privacy}",
        "received_events_url": "https://api.github.com/users/trevor-coleman/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": [
        {
            "url": "https://api.github.com/repos/Expensify/App/issues/comments/1821663181",
            "html_url": "https://github.com/Expensify/App/pull/31656#issuecomment-1821663181",
            "issue_url": "https://api.github.com/repos/Expensify/App/issues/31656",
            "id": 1821663181,
            "node_id": "IC_kwDOEQqHYc5slF_N",
            "user": {
                "login": "github-actions[bot]",
                "id": 41898282,
                "node_id": "MDM6Qm90NDE4OTgyODI=",
                "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/github-actions%5Bbot%5D",
                "html_url": "https://github.com/apps/github-actions",
                "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
                "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
                "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
                "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
                "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
                "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
                "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
                "type": "Bot",
                "site_admin": false
            },
            "created_at": "2023-11-21T20:54:01Z",
            "updated_at": "2023-11-22T17:14:40Z",
            "author_association": "CONTRIBUTOR",
            "body": "****CLA Assistant Lite bot**** All contributors have signed the CLA  \u270d\ufe0f \u2705",
            "reactions": {
                "url": "https://api.github.com/repos/Expensify/App/issues/comments/1821663181/reactions",
                "total_count": 0,
                "+1": 0,
                "-1": 0,
                "laugh": 0,
                "hooray": 0,
                "confused": 0,
                "heart": 0,
                "rocket": 0,
                "eyes": 0
            },
            "performed_via_github_app": {
                "id": 15368,
                "slug": "github-actions",
                "node_id": "MDM6QXBwMTUzNjg=",
                "owner": {
                    "login": "github",
                    "id": 9919,
                    "node_id": "MDEyOk9yZ2FuaXphdGlvbjk5MTk=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9919?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/github",
                    "html_url": "https://github.com/github",
                    "followers_url": "https://api.github.com/users/github/followers",
                    "following_url": "https://api.github.com/users/github/following{/other_user}",
                    "gists_url": "https://api.github.com/users/github/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/github/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/github/subscriptions",
                    "organizations_url": "https://api.github.com/users/github/orgs",
                    "repos_url": "https://api.github.com/users/github/repos",
                    "events_url": "https://api.github.com/users/github/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/github/received_events",
                    "type": "Organization",
                    "site_admin": false
                },
                "name": "GitHub Actions",
                "description": "Automate your workflow from idea to production",
                "external_url": "https://help.github.com/en/actions",
                "html_url": "https://github.com/apps/github-actions",
                "created_at": "2018-07-30T09:30:17Z",
                "updated_at": "2019-12-10T19:04:12Z",
                "permissions": {
                    "actions": "write",
                    "administration": "read",
                    "checks": "write",
                    "contents": "write",
                    "deployments": "write",
                    "discussions": "write",
                    "issues": "write",
                    "merge_queues": "write",
                    "metadata": "read",
                    "packages": "write",
                    "pages": "write",
                    "pull_requests": "write",
                    "repository_hooks": "write",
                    "repository_projects": "write",
                    "security_events": "write",
                    "statuses": "write",
                    "vulnerability_alerts": "read"
                },
                "events": [
                    "branch_protection_rule",
                    "check_run",
                    "check_suite",
                    "create",
                    "delete",
                    "deployment",
                    "deployment_status",
                    "discussion",
                    "discussion_comment",
                    "fork",
                    "gollum",
                    "issues",
                    "issue_comment",
                    "label",
                    "merge_group",
                    "milestone",
                    "page_build",
                    "project",
                    "project_card",
                    "project_column",
                    "public",
                    "pull_request",
                    "pull_request_review",
                    "pull_request_review_comment",
                    "push",
                    "registry_package",
                    "release",
                    "repository",
                    "repository_dispatch",
                    "status",
                    "watch",
                    "workflow_dispatch",
                    "workflow_run"
                ]
            }
        },
        {
            "url": "https://api.github.com/repos/Expensify/App/issues/comments/1821665611",
            "html_url": "https://github.com/Expensify/App/pull/31656#issuecomment-1821665611",
            "issue_url": "https://api.github.com/repos/Expensify/App/issues/31656",
            "id": 1821665611,
            "node_id": "IC_kwDOEQqHYc5slGlL",
            "user": {
                "login": "trevor-coleman",
                "id": 22041394,
                "node_id": "MDQ6VXNlcjIyMDQxMzk0",
                "avatar_url": "https://avatars.githubusercontent.com/u/22041394?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/trevor-coleman",
                "html_url": "https://github.com/trevor-coleman",
                "followers_url": "https://api.github.com/users/trevor-coleman/followers",
                "following_url": "https://api.github.com/users/trevor-coleman/following{/other_user}",
                "gists_url": "https://api.github.com/users/trevor-coleman/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/trevor-coleman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/trevor-coleman/subscriptions",
                "organizations_url": "https://api.github.com/users/trevor-coleman/orgs",
                "repos_url": "https://api.github.com/users/trevor-coleman/repos",
                "events_url": "https://api.github.com/users/trevor-coleman/events{/privacy}",
                "received_events_url": "https://api.github.com/users/trevor-coleman/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2023-11-21T20:56:04Z",
            "updated_at": "2023-11-21T20:56:04Z",
            "author_association": "NONE",
            "body": "I have read the CLA Document and I hereby sign the CLA",
            "reactions": {
                "url": "https://api.github.com/repos/Expensify/App/issues/comments/1821665611/reactions",
                "total_count": 0,
                "+1": 0,
                "-1": 0,
                "laugh": 0,
                "hooray": 0,
                "confused": 0,
                "heart": 0,
                "rocket": 0,
                "eyes": 0
            },
            "performed_via_github_app": null
        },
        {
            "url": "https://api.github.com/repos/Expensify/App/issues/comments/1823184957",
            "html_url": "https://github.com/Expensify/App/pull/31656#issuecomment-1823184957",
            "issue_url": "https://api.github.com/repos/Expensify/App/issues/31656",
            "id": 1823184957,
            "node_id": "IC_kwDOEQqHYc5sq5g9",
            "user": {
                "login": "melvin-bot[bot]",
                "id": 101365710,
                "node_id": "BOT_kgDOBgq3zg",
                "avatar_url": "https://avatars.githubusercontent.com/in/179547?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/melvin-bot%5Bbot%5D",
                "html_url": "https://github.com/apps/melvin-bot",
                "followers_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/followers",
                "following_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/following{/other_user}",
                "gists_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/subscriptions",
                "organizations_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/orgs",
                "repos_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/repos",
                "events_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/events{/privacy}",
                "received_events_url": "https://api.github.com/users/melvin-bot%5Bbot%5D/received_events",
                "type": "Bot",
                "site_admin": false
            },
            "created_at": "2023-11-22T17:20:06Z",
            "updated_at": "2023-11-22T17:20:06Z",
            "author_association": "NONE",
            "body": "@situchan Please copy/paste the Reviewer Checklist from [here](https://raw.githubusercontent.com/Expensify/App/main/contributingGuides/REVIEWER_CHECKLIST.md) into a new comment on this PR and complete it. If you have the K2 extension, you can simply click: [this button]",
            "reactions": {
                "url": "https://api.github.com/repos/Expensify/App/issues/comments/1823184957/reactions",
                "total_count": 0,
                "+1": 0,
                "-1": 0,
                "laugh": 0,
                "hooray": 0,
                "confused": 0,
                "heart": 0,
                "rocket": 0,
                "eyes": 0
            },
            "performed_via_github_app": {
                "id": 179547,
                "slug": "melvin-bot",
                "node_id": "A_kwDOAL20aM4AAr1b",
                "owner": {
                    "login": "MelvinBot",
                    "id": 12432488,
                    "node_id": "MDQ6VXNlcjEyNDMyNDg4",
                    "avatar_url": "https://avatars.githubusercontent.com/u/12432488?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/MelvinBot",
                    "html_url": "https://github.com/MelvinBot",
                    "followers_url": "https://api.github.com/users/MelvinBot/followers",
                    "following_url": "https://api.github.com/users/MelvinBot/following{/other_user}",
                    "gists_url": "https://api.github.com/users/MelvinBot/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/MelvinBot/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/MelvinBot/subscriptions",
                    "organizations_url": "https://api.github.com/users/MelvinBot/orgs",
                    "repos_url": "https://api.github.com/users/MelvinBot/repos",
                    "events_url": "https://api.github.com/users/MelvinBot/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/MelvinBot/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "name": "Melvin Bot",
                "description": "A bot by @Expensify",
                "external_url": "https://github.com/Expensify",
                "html_url": "https://github.com/apps/melvin-bot",
                "created_at": "2022-03-10T21:25:44Z",
                "updated_at": "2023-04-06T18:19:40Z",
                "permissions": {
                    "checks": "read",
                    "contents": "read",
                    "issues": "write",
                    "members": "read",
                    "metadata": "read",
                    "pull_requests": "write"
                },
                "events": []
            }
        },
        {
            "url": "https://api.github.com/repos/Expensify/App/issues/comments/1823188634",
            "html_url": "https://github.com/Expensify/App/pull/31656#issuecomment-1823188634",
            "issue_url": "https://api.github.com/repos/Expensify/App/issues/31656",
            "id": 1823188634,
            "node_id": "IC_kwDOEQqHYc5sq6aa",
            "user": {
                "login": "situchan",
                "id": 108292595,
                "node_id": "U_kgDOBnRp8w",
                "avatar_url": "https://avatars.githubusercontent.com/u/108292595?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/situchan",
                "html_url": "https://github.com/situchan",
                "followers_url": "https://api.github.com/users/situchan/followers",
                "following_url": "https://api.github.com/users/situchan/following{/other_user}",
                "gists_url": "https://api.github.com/users/situchan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/situchan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/situchan/subscriptions",
                "organizations_url": "https://api.github.com/users/situchan/orgs",
                "repos_url": "https://api.github.com/users/situchan/repos",
                "events_url": "https://api.github.com/users/situchan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/situchan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2023-11-22T17:22:41Z",
            "updated_at": "2023-11-22T17:22:41Z",
            "author_association": "CONTRIBUTOR",
            "body": "I see that there is no way to test it but is is possible to have temporary test by manually changing some code locally?",
            "reactions": {
                "url": "https://api.github.com/repos/Expensify/App/issues/comments/1823188634/reactions",
                "total_count": 0,
                "+1": 0,
                "-1": 0,
                "laugh": 0,
                "hooray": 0,
                "confused": 0,
                "heart": 0,
                "rocket": 0,
                "eyes": 0
            },
            "performed_via_github_app": null
        }
    ],
    "created_at": "2023-11-21T20:53:47Z",
    "updated_at": "2023-11-22T17:22:42Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "draft": false,
    "pull_request": {
        "url": "https://api.github.com/repos/Expensify/App/pulls/31656",
        "html_url": "https://github.com/Expensify/App/pull/31656",
        "diff_url": "https://github.com/Expensify/App/pull/31656.diff",
        "patch_url": "https://github.com/Expensify/App/pull/31656.patch",
        "merged_at": null
    },
    "body": "### Details\r\n\r\nThis PR implements the ViolationUtils lib, as specified in [this issue](https://github.com/Expensify/App/issues/31083).\r\n\r\n#### Notes on Implementation\r\n\r\n**Created `possibleViolationByField` for use in `get**\r\n\r\nI found it easier to reason about the filtering of the violations by field when it was organized\r\nas a map from field to possible violations. But it's much easier to maintain the list of\r\nrelationships when it's defined as a map from violation to field.\r\n\r\nTo resolve this I created an intermediate variable `possibleViolationByField`\r\nthat inverts the mapping using `lodash/invertBy` and then use that for the lookup. \r\n\r\nThis lets us keep the maintainability of the single list, while also letting us use the more readable form in code.\r\n\r\nPerformance isn't a significant concern with lists this small, but creating the lookup once is more performant nonetheless.\r\n\r\n#### Changes to Onyx Types\r\n\r\n**Added `PolicyCategories` type**\r\n\r\n* needed for `getViolationsOnyxData`\r\n* used `PolicyTags` as an example\r\n\r\n##### Added `TRANSACTION_VIOLATIONS` to `ONXYKEYS.COLLECTION`\r\n\r\n* used `transactionViolations_` to follow the pattern\r\n\r\n##### Created `TransactionViolation` and related types\r\n\r\n* Created the `TransactionViolation` type and string literal unions for the various types [as discussed here](https://github.com/Expensify/App/issues/31083#issuecomment-1817113219)\r\n\r\n### Fixed Issues\r\n$ https://github.com/Expensify/App/issues/31083\r\n\r\n\r\n### Tests\r\n\r\nThis code is not called yet by the application, so there is no way to test it.\r\n\r\n- [x] Verify that no errors appear in the JS console\r\n\r\n### Offline tests\r\nThis code is not called yet by the application, so there is no way to test it.\r\n\r\n### QA Steps\r\nThis code is not called yet by the application, so there is no way to test it.\r\n\r\n- [x] Verify that no errors appear in the JS console\r\n\r\n### PR Author Checklist\r\n- [x] I linked the correct issue in the `### Fixed Issues` section above\r\n- [x] I wrote clear testing steps that cover the changes made in this PR\r\n    - [x] I added steps for local testing in the `Tests` section\r\n    - [x] I added steps for the expected offline behavior in the `Offline steps` section\r\n    - [x] I added steps for Staging and/or Production testing in the `QA steps` section\r\n    - [x] I added steps to cover failure scenarios (i.e. verify an input displays the correct error message if the entered data is not correct)\r\n    - [x] I turned off my network connection and tested it while offline to ensure it matches the expected behavior (i.e. verify the default avatar icon is displayed if app is offline)\r\n    - [x] I tested this PR with a [High Traffic account](https://github.com/Expensify/App/blob/main/contributingGuides/CONTRIBUTING.md#high-traffic-accounts) against the staging or production API to ensure there are no regressions (e.g. long loading states that impact usability).\r\n- [x] I included screenshots or videos for tests on [all platforms](https://github.com/Expensify/App/blob/main/contributingGuides/CONTRIBUTING.md#make-sure-you-can-test-on-all-platforms)\r\n- [x] I ran the tests on **all platforms** & verified they passed on:\r\n    - [x] Android: Native\r\n    - [x] Android: mWeb Chrome\r\n    - [x] iOS: Native\r\n    - [x] iOS: mWeb Safari\r\n    - [x] MacOS: Chrome / Safari\r\n    - [x] MacOS: Desktop\r\n- [x] I verified there are no console errors (if there's a console error not related to the PR, report it or open an issue for it to be fixed)\r\n- [x] I followed proper code patterns (see [Reviewing the code](https://github.com/Expensify/App/blob/main/contributingGuides/PR_REVIEW_GUIDELINES.md#reviewing-the-code))\r\n    - [x] I verified that any callback methods that were added or modified are named for what the method does and never what callback they handle (i.e. `toggleReport` and not `onIconClick`)\r\n    - [x] I verified that the left part of a conditional rendering a React component is a boolean and NOT a string, e.g. `myBool && <MyComponent />`.\r\n    - [x] I verified that comments were added to code that is not self explanatory\r\n    - [x] I verified that any new or modified comments were clear, correct English, and explained \"why\" the code was doing something instead of only explaining \"what\" the code was doing.\r\n    - [x] I verified any copy / text shown in the product is localized by adding it to `src/languages/*` files and using the [translation method](https://github.com/Expensify/App/blob/4bd99402cebdf4d7394e0d1f260879ea238197eb/src/components/withLocalize.js#L60)\r\n      - [x] If any non-english text was added/modified, I verified the translation was requested/reviewed in #expensify-open-source and it was approved by an internal Expensify engineer. Link to Slack message:\r\n    - [x] I verified all numbers, amounts, dates and phone numbers shown in the product are using the [localization methods](https://github.com/Expensify/App/blob/4bd99402cebdf4d7394e0d1f260879ea238197eb/src/components/withLocalize.js#L60-L68)\r\n    - [x] I verified any copy / text that was added to the app is grammatically correct in English. It adheres to proper capitalization guidelines (note: only the first word of header/labels should be capitalized), and is approved by marketing by adding the `Waiting for Copy` label for a copy review on the original GH to get the correct copy.\r\n    - [x] I verified proper file naming conventions were followed for any new files or renamed files. All non-platform specific files are named after what they export and are not named \"index.js\". All platform-specific files are named for the platform the code supports as outlined in the README.\r\n    - [x] I verified the JSDocs style guidelines (in [`STYLE.md`](https://github.com/Expensify/App/blob/main/contributingGuides/STYLE.md#jsdocs)) were followed\r\n- [x] If a new code pattern is added I verified it was agreed to be used by multiple Expensify engineers\r\n- [x] I followed the guidelines as stated in the [Review Guidelines](https://github.com/Expensify/App/blob/main/contributingGuides/PR_REVIEW_GUIDELINES.md)\r\n- [x] I tested other components that can be impacted by my changes (i.e. if the PR modifies a shared library or component like `Avatar`, I verified the components using `Avatar` are working as expected)\r\n- [x] I verified all code is DRY (the PR doesn't include any logic written more than once, with the exception of tests)\r\n- [x] I verified any variables that can be defined as constants (ie. in CONST.js or at the top of the file that uses the constant) are defined as such\r\n- [x] I verified that if a function's arguments changed that all usages have also been updated correctly\r\n- [x] If any new file was added I verified that:\r\n    - [x] The file has a description of what it does and/or why is needed at the top of the file if the code is not self explanatory\r\n- [x] If a new CSS style is added I verified that:\r\n    - [x] A similar style doesn't already exist\r\n    - [x] The style can't be created with an existing [StyleUtils](https://github.com/Expensify/App/blob/main/src/styles/StyleUtils.js) function (i.e. `StyleUtils.getBackgroundAndBorderStyle(themeColors.componentBG)`)\r\n- [x] If the PR modifies code that runs when editing or sending messages, I tested and verified there is no unexpected behavior for all supported markdown - URLs, single line code, code blocks, quotes, headings, bold, strikethrough, and italic.\r\n- [x] If the PR modifies a generic component, I tested and verified that those changes do not break usages of that component in the rest of the App (i.e. if a shared library or component like `Avatar` is modified, I verified that `Avatar` is working as expected in all cases)\r\n- [x] If the PR modifies a component related to any of the existing Storybook stories, I tested and verified all stories for that component are still working as expected.\r\n- [x] If the PR modifies a component or page that can be accessed by a direct deeplink, I verified that the code functions as expected when the deeplink is used - from a logged in and logged out account.\r\n- [x] If a new page is added, I verified it's using the `ScrollView` component to make it scrollable when more elements are added to the page.\r\n- [x] If the `main` branch was merged into this PR after a review, I tested again and verified the outcome was still expected according to the `Test` steps.\r\n\r\n### Screenshots/Videos\r\n\r\nNo visible changes",
    "reactions": {
        "url": "https://api.github.com/repos/Expensify/App/issues/31656/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/Expensify/App/issues/31656/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}